{% extends 'partials/base.html' %} {% load static %} {% block title %}
Carlisting! VROOM {% endblock %} {% block content%}

<div class="all">
  <div class="filter">
    <button class="filter-btn" data-category="all">All</button>
    <button class="filter-btn" data-category="SUV">SUV</button>
    <button class="filter-btn" data-category="EV">EV</button>
    <button class="filter-btn" data-category="Truck">Truck</button>
    <button class="filter-btn" data-category="Sedan">Sedan</button>
  </div>

  <!-- Displayed after clicking view details -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <span class="close">&times;</span>
      <h2>Car Details</h2>
      <div id="popup-details"></div>
      <button id="bookButton">Book Now</button>
    </div>
  </div>

  <div class="cards-container">
    <!-- Cards will be dynamically added here -->
    {% for item in items %}
    <div class="card">
      <img src="{{ item.image.url }}" alt="Car Image">
      <div class="card-details">
        <h2 class="car-model">{{ item.car_model }}</h2>
        <h4 class="renter-name">{{ item.renter_name }}</h4>
        <p class="car-type">Type: {{ item.car_type }}</p>
        <p class="car-price">Price: {{ item.price }}</p>
        <button class="view-details">View details</button>
      </div>
    </div>
    {% endfor %}
  </div>

  <div class="page-btn">
    <button id="previousPageBtn">Previous Page</button>
    <h2 class="page-number"></h2>
    <button id="nextPageBtn">Next Page</button>
  </div>
</div>




  <script>
  function showPopup(cardData) {
    var popup = document.getElementById("popup");
    var popupDetails = document.getElementById("popup-details");
    popupDetails.innerHTML = `
                <img src="${cardData.image}" alt="${cardData.model}">
                <p>Model: ${cardData.model}</p>
                <p>Price: ${cardData.price}</p>
            `;
    popup.style.display = "block";
  }

  document.addEventListener("DOMContentLoaded", function () {
    
    var filterButtons = document.querySelectorAll('.filter-btn');
    var cards = document.querySelectorAll('.card');
    var cardsPerPage = 5; // Set the number of cards per page
    var currentPage = 1; // Initialize current page

    // Function to display filtered cards for the current page
    function displayFilteredCards() {
      var filteredCards = document.querySelectorAll('.filtered');
      var startIndex = (currentPage - 1) * cardsPerPage;
      var endIndex = startIndex + cardsPerPage;
      var pagenum = document.querySelector('.page-number');
      pagenum.innerHTML = currentPage;
      filteredCards.forEach(function (card, index) {
        if (index >= startIndex && index < endIndex) {
          card.style.display = "block";
        } else {
          card.style.display = "none";
        }
      });
    }

       filterButtons.forEach(function (button) {
      button.addEventListener("click", function () {
        currentPage = 1;
        var category = this.getAttribute("data-category");
        var thisButton = document.querySelector('.filter-btn[data-category="' + category + '"]');

        // Change the color of the button pressed
        filterButtons.forEach(function (btn) {
          btn.style.backgroundColor = "#2f6690";
        });
        thisButton.style.backgroundColor = "#16425b";

        // Filtering the cards according to the button pressed
        cards.forEach(function (card) {
          card.classList.remove("filtered");
          console.log(category);
          console.log(card);
          var cardCategory = card.querySelector(".car-type").textContent.split(":")[1].trim(); // Assuming category is retrieved from card content
          if (category == "all" || category == cardCategory) {
            card.classList.add("filtered");
            card.style.display = "block";
          } else {
            card.style.display = "none";
          }
        });

        // Display filtered cards on current page
        displayFilteredCards();
      });
    });

     // pressing all button on start
     var allButton = document.querySelector('.filter-btn[data-category="all"]');
    if (allButton) {
        allButton.click();
        console.log("All button clicked");
        displayFilteredCards();
    } else {
        console.error("All button not found");
    }

    // Add event listener for "Next Page" button
    nextPageBtn.addEventListener("click", function () {
      var totalPages = Math.ceil(document.querySelectorAll('.filtered').length / cardsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        displayFilteredCards();
      }
    });

    // Add event listener for "Previous Page" button
    previousPageBtn.addEventListener("click", function () {
      if (currentPage > 1) {
        currentPage--;
        displayFilteredCards();
      }
    });
});




//   var nextPageBtn = document.getElementById("nextPageBtn");
//   var previousPageBtn = document.getElementById("previousPageBtn");

//   document.addEventListener("DOMContentLoaded", function () {
//   var filterButtons = document.querySelectorAll('.filter-btn');
//   var cards = document.querySelectorAll('.card');

//   filterButtons.forEach(function (button) {
//     button.addEventListener("click", function () {
//       var category = this.getAttribute("data-category");
//       thisbutton = document.querySelector('.filter-btn[data-category="'+category+'"]');

//       // changing the color of the button pressed
//       filterButtons.forEach(function (btn) {
//         btn.style.backgroundColor = "#2f6690"; 
//       });
//       thisbutton.style.backgroundColor = "#16425b";

//       // filtering the cards according to button pressed
//       cards.forEach(function (card) {
//         var cardCategory = card.querySelector(".car-type").textContent.split(":")[1].trim(); // Assuming category is retrieved from card content
//         if (category == "all" || category == cardCategory) {
//           card.style.display = "block";
//         } else {
//           card.style.display = "none";
//         }
//       });
//     });
//   });
// });


  // Popup Close
  document.querySelector(".close").addEventListener("click", function () {
    document.getElementById("popup").style.display = "none";
  });

  //Book button
  document.getElementById("bookButton").addEventListener("click", function () {
    alert("Change the functionality of the book button");
  });

</script>

<!-- CSS -->
<style>
 

  body {
    margin-top: 10vh;
  }
  .all {
    width: 80vw;
    margin-left: 10%;
  }

  .filter {
    margin: 40px 2%;
    padding-top: 20px;
  }

  .filter-btn {
    padding: 8px 16px;
    border: none;
    background-color: #2f6690;
    color: #d9dcd6;
    cursor: pointer;
    border-radius: 5px;
    margin-right: 10px;
    font-size: medium;
  }

  .filter-btn:hover {
    background-color: #16425b;
  }

  .cards-container {
    height: auto;
    display: flex;
    flex-wrap: wrap;
    justify-content:space-evenly;
    padding: 0 20px;
  }

  .card {
    height: 35vh;
    width: 18vw;
    margin: 2px;
    background-color: #d9dcd6;
    border: 1px solid #d9dcd6;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 5px;
    box-sizing: border-box;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .card:hover{
    background-color: #b4b4b3;
  }

  .card img {
    margin-left: 5%;
    margin-top: 5%;
    margin-bottom: 10px;
    width: 90%;
    height: 50%;
  }

  .card-content {
    margin-top: 20px;
    padding-left: 10%;
  }

  .model {
    padding-top: 3%;
    padding-bottom: 3%;
    font-size: 1.2rem;
    font-weight: 450;
  }

  .price {
    font-size: 1.5rem;
    font-weight: 500;
  }

  .cardbtn {
    margin-top: 10px;
    width: 80%;
    font-weight: bold;
    font-size: large;
  }

  .page-btn {
    margin-top: 20px;
    display: flex;
    flex-direction: row;
    text-align: center;
    justify-content: center;
  }

  .page-btn button {
    padding: 10px 20px;
    background-color: #2f6690;
    color: #d9dcd6;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-right: 10px;
    margin-bottom: 10px;
  }

  .page-btn button:hover {
    background-color: #16425b;
  }

  .popup {
    display: none;
    position: fixed;
    z-index: 1001;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .popup-content {
    background-color: #d9dcd6;

    margin-top: 15vh;
    padding: 20px;
    border: 1px solid #888;
    width: 70%;
    height: 60%;
    border-radius: 5px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    position: relative;
  }

  .popup-content h2 {
    margin-top: 10px;
    margin-bottom: 20px;
  }

  .popup-content img {
    width: 90%;
    margin-bottom: 5px;
    margin-left: 5%;
    margin-right: 10%;
    height: 40vh;
  }

  .popup-content p {
    margin-top: 5px;
    font-weight: 600;
    font-size: 1.3rem;
    padding-left: 2vw;
  }

  .popup-content button {
    padding: 10px 20px;
    margin-left: 2vw;
    background-color: #2f6690;
    color: #d9dcd6;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 15px;
    right: 0;
  }

  .popup-content button:hover {
    background-color: #16425b;
  }

  .close {
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
    font-size: 24px;
  }
</style>

{% endblock %}
